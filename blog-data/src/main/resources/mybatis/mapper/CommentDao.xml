<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.jxufe.dao.CommentDao">

    <resultMap id="FistLoadedCommentVo" type="cn.jxufe.entity.vo.FistLoadedCommentVo">
        <id column="parentId" javaType="integer" property="id"/>
        <collection property="childrenComments" column="{parentId=parentId}" select="selectChildCommentByParentId" ofType="cn.jxufe.entity.Comment" javaType="ArrayList"/>
    </resultMap>

    <select id="selectChildCommentByParentId" resultType="cn.jxufe.entity.Comment">
        select *
        from comment
        where parent_id = #{parentId}
        limit 1
    </select>

    <select id="selectFistLoadedCommentByBlogId" resultMap="FistLoadedCommentVo">
        select id as parentId, content as parentContent, user_id as parentCommentUserId, create_time as parentCreateTime
        from comment
        where blog_id = #{blogId}
          and parent_id = 0
        limit #{parentCommentNum}
    </select>

</mapper>